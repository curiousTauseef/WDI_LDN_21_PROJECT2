<h1>Inbox</h1>

<ul>
  <% @conversations.each do |conversation| %>
  <% receiver = conversation.sender_id == current_user.id ? conversation.receiver : conversation.sender %>


  <% unread_message_count = conversation.messages.where("user_id != ? AND read = ?", current_user.id, false).count %>


  <li><%= link_to receiver.username, conversation_messages_path(conversation) %> <%= unread_message_count %></li>
  <% end %>
</ul>

<h2>Users</h2>
<ul>
  <% @users.each do |user| %>
  <li><%= link_to user.username, conversations_path(sender_id: current_user.id, receiver_id: user.id), method: :post%></li>
  <% end %>
</ul>